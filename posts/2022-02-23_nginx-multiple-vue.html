<!DOCTYPE html><html><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="renderer" content="webkit"><meta name="author" content="HeZulong"><meta name="keywords" content="ä½•ç¥–é¾™, hezulong, zulong"><meta name="description" content="ä½•ç¥–é¾™"><meta name="theme-color" content="#000000"><link rel="icon" href="/logo.png" type="image/svg+xml"><link href="//fonts.googleapis.com/css2?family=Fira+Code&amp;family=Inter:wght@200;400;600&amp;display=swap" rel="stylesheet"><title>ä½¿ç”¨ nginx åŒåŸŸåä¸‹éƒ¨ç½²å¤šä¸ª vue é¡¹ç›®ï¼Œå¹¶ä½¿ç”¨åå‘ä»£ç†</title><script>!function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=localStorage.getItem("vueuse-color-scheme")||"auto";("dark"===t||e&&"light"!==t)&&document.documentElement.classList.toggle("dark",!0)}()</script><script type="module" async="" crossorigin="" src="/assets/app.8339360d.js"></script><link rel="modulepreload" href="/assets/vendor.8b079578.js"><link rel="stylesheet" href="/assets/app.c1706c9e.css"><link rel="modulepreload" crossorigin="" href="/assets/2022-02-23_nginx-multiple-vue.3ca92989.js"><link rel="modulepreload" crossorigin="" href="/assets/Post.2523a346.js"><meta name="description" content="ä½•ç¥–é¾™çš„ä¸ªäººç½‘ç«™, hezulong's Portfolio"><meta property="og:title" content="ä½¿ç”¨ nginx åŒåŸŸåä¸‹éƒ¨ç½²å¤šä¸ª vue é¡¹ç›®ï¼Œå¹¶ä½¿ç”¨åå‘ä»£ç†"><meta name="head:count" content="2"></head><body class="font-sans text-gray-700 dark:text-gray-200"><div id="app" data-server-rendered="true"><!--[--><header class="header z-40" data-v-7ecc8847=""><a href="/" class="w-8 h-8 absolute lg:fixed m-7 select-none outline-none" focusable="false" data-v-7ecc8847=""><div class="bg-accentLight rounded-full w-8 h-8" data-v-7ecc8847=""></div></a><nav class="nav" data-v-7ecc8847=""><div class="spacer" data-v-7ecc8847=""></div><div class="right" data-v-7ecc8847=""><a href="/posts" class="" data-v-7ecc8847=""><span class="<md:hidden" data-v-7ecc8847="">Blog</span><svg style="vertical-align:sub" class="inline md:hidden" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" data-v-7ecc8847=""><path fill="currentColor" d="M26 30H6a2.002 2.002 0 0 1-2-2V4a2.002 2.002 0 0 1 2-2h20a2.002 2.002 0 0 1 2 2v24a2.002 2.002 0 0 1-2 2ZM6 4v24h20V4Z"></path><path fill="currentColor" d="M9 7h11v2H9zm0 5h7v2H9z"></path></svg></a><a href="/talks" class="<md:hidden" data-v-7ecc8847="">Talks </a><a href="/projects" class="" data-v-7ecc8847=""><span class="<md:hidden" data-v-7ecc8847="">Projects</span><svg style="vertical-align:sub" class="inline md:hidden" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" data-v-7ecc8847=""><path fill="currentColor" d="M11 24h10v2H11zm2 4h6v2h-6zm3-26A10 10 0 0 0 6 12a9.19 9.19 0 0 0 3.46 7.62c1 .93 1.54 1.46 1.54 2.38h2c0-1.84-1.11-2.87-2.19-3.86A7.2 7.2 0 0 1 8 12a8 8 0 0 1 16 0a7.2 7.2 0 0 1-2.82 6.14c-1.07 1-2.18 2-2.18 3.86h2c0-.92.53-1.45 1.54-2.39A9.18 9.18 0 0 0 26 12A10 10 0 0 0 16 2z"></path></svg></a><!----><!----><!----></div></nav></header><main class="px-7 py-10"><!--[--><div class="prose m-auto mb-8"><h1 class="mb-0">ä½¿ç”¨ nginx åŒåŸŸåä¸‹éƒ¨ç½²å¤šä¸ª vue é¡¹ç›®ï¼Œå¹¶ä½¿ç”¨åå‘ä»£ç†</h1><p class="opacity-50 !-mt-2">02æœˆ23æ—¥ <span>Â· 12åˆ†é’Ÿ</span></p><p class="opacity-50 !-mt-6 italic">æœ¬æ–‡é¦–å‘äº2019/02/27ï¼Œå¯èƒ½ä¸ç°åœ¨çš„æŠ€æœ¯æœ‰äº›å‡ºå…¥ã€‚</p></div><article><!--[--><div class="prose m-auto"><p></p><div class="table-of-contents"><ul><li><a href="#æ•ˆæœ">æ•ˆæœ</a></li><li><a href="#vue-çš„é…ç½®">Vue çš„é…ç½®</a></li><li><a href="#nginx-çš„é…ç½®">Nginx çš„é…ç½®</a></li><li><a href="#æœ€åçš„è°ƒè¯•">æœ€åçš„è°ƒè¯•</a></li></ul></div><p></p><p>èŠ±äº† 3 å¤©æ—¶é—´ï¼Œè¶ç€æˆ‘è¿˜æ²¡æœ‰å¿˜è®°ï¼Œå…ˆè®°å½•ä¸‹æ¥ã€‚</p><h2 id="æ•ˆæœ" tabindex="-1">æ•ˆæœ <a class="header-anchor" href="#æ•ˆæœ" aria-hidden="true">#</a></h2><p>å‡è®¾æˆ‘ä»¬ç›®å‰æœ‰ä¸¤ä¸ªé¡¹ç›® project1 å’Œ project2ï¼Œè¿˜æœ‰ä¸€ä¸ª nginx è‡ªå¸¦çš„ index.html é¡µé¢ï¼Œåœ¨ index.html ä¸­æ·»åŠ é¡¹ç›®çš„å¯¹åº”é“¾æ¥ï¼ˆç¨åç²˜è´´å‡ºæ¥ï¼‰ï¼Œä¸ºäº†ç»Ÿä¸€ç®¡ç†å­é¡¹ç›®çš„è·¯ç”±ã€‚</p><p>æœŸæœ›å®ç°ä¸‹é¢çš„æ•ˆæœï¼š</p><pre class="language-bash"><code class="language-bash">http://localhost:8080/ è¿›å…¥æœ€å¤–å±‚çš„ index.html
http://localhost:8080/project1 è¿›å…¥é¡¹ç›®ä¸€
http://localhost:8080/project2 è¿›å…¥é¡¹ç›®äºŒ
</code></pre><p>åºŸè¯ä¸å¤šè¯´ï¼Œå¼€å§‹é…ç½®</p><h2 id="vue-çš„é…ç½®" tabindex="-1">Vue çš„é…ç½® <a class="header-anchor" href="#vue-çš„é…ç½®" aria-hidden="true">#</a></h2><blockquote><p>æœ¬äººä½¿ç”¨çš„æ˜¯ <code>vue-cli2</code> æ­å»ºçš„é¡¹ç›®ï¼Œæ‰€ä»¥å¯¹åº”çš„éœ€è¦ä¿®æ”¹ä¸€äº› <code>vue</code> çš„é…ç½®å‚æ•°ã€‚</p></blockquote><ul><li>config æ–‡ä»¶å¤¹ä¸‹çš„ index.jsï¼Œå› ä¸ºæ˜¯æ‰“åŒ…ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ <code>build.assetsPublicPath</code> æ›´æ”¹å¯¹åº”é¡¹ç›®åï¼Œè­¬å¦‚</li></ul><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// project1</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">dev</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">build</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">assetsPublicPath</span><span class="token operator">:</span> <span class="token string">'/project1/'</span> <span class="token comment">// æ³¨æ„å‰åçš„ â€˜/â€™</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// project2</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">dev</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">build</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">assetsPublicPath</span><span class="token operator">:</span> <span class="token string">'/project2/'</span> <span class="token comment">// æ³¨æ„å‰åçš„ â€˜/â€™</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><ul><li>config æ–‡ä»¶å¤¹ä¸‹çš„ prod.env.js ä¿®æ”¹æˆè¿™æ ·ï¼š</li></ul><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// project1</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">NODE_ENV</span><span class="token operator">:</span> <span class="token string">'"production"'</span><span class="token punctuation">,</span>
  <span class="token constant">BASE_API</span><span class="token operator">:</span> <span class="token string">'"/api/pro1"'</span> <span class="token comment">// è¿™é‡Œå¾…ä¼šä¸ nginx é…ç½®å¯¹åº”</span>
<span class="token punctuation">}</span>

<span class="token comment">// project2</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">NODE_ENV</span><span class="token operator">:</span> <span class="token string">'"production"'</span><span class="token punctuation">,</span>
  <span class="token constant">BASE_API</span><span class="token operator">:</span> <span class="token string">'"/api/pro2"'</span> <span class="token comment">// è¿™é‡Œå¾…ä¼šä¸ nginx é…ç½®å¯¹åº”</span>
<span class="token punctuation">}</span>
</code></pre><p><strong>[æ³¨æ„]</strong> å› ä¸ºæˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨åˆ°äº† <code>BASE_API</code> ä½œä¸ºä»£ç†çš„å‰ç¼€ï¼Œå¦‚æœä½ çš„ä¸åœ¨è¿™è¾¹ï¼Œä½ éœ€è¦æ‰¾åˆ°ä½ è‡ªå·±çš„ä»£ç†é…ç½®</p><ul><li>å› ä¸ºæ¯ä¸ªäººçš„ <code>vue-router</code> æ–‡ä»¶é…ç½®ä¸ä¸€æ ·ï¼Œä½ éœ€è¦æ‰¾åˆ°ä½ çš„ router é…ç½®æ–‡ä»¶ï¼Œå†…éƒ¨ä¿®æ”¹ä¸ºï¼š</li></ul><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// æˆ‘é‡‡ç”¨äº† history æ¨¡å¼ï¼Œhash æ¨¡å¼æˆ‘æ²¡æœ‰æµ‹è¯•ï¼Œæ„Ÿè§‰åº”è¯¥æ˜¯ä¸€æ ·çš„æ•ˆæœ</span>
<span class="token comment">// project1</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">'/project1/'</span><span class="token punctuation">,</span> <span class="token comment">// æ³¨æ„æ›´æ”¹ä½ å­é¡¹ç›®åï¼Œè¿™ä¸ªå¯¹åº”ä½ çš„ build.assetsPublicPath</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">scrollBehavior</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// æ³¨æ„è¿™æ˜¯ vue-router@3 ä¸­çš„å†™æ³•</span>
  <span class="token literal-property property">routes</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// project2</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">'/project2/'</span><span class="token punctuation">,</span> <span class="token comment">// æ³¨æ„æ›´æ”¹ä½ å­é¡¹ç›®åï¼Œè¿™ä¸ªå¯¹åº”ä½ çš„ build.assetsPublicPath</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">scrollBehavior</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// æ³¨æ„è¿™æ˜¯ vue-router@3 ä¸­çš„å†™æ³•</span>
  <span class="token literal-property property">routes</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p><strong>[æ³¨æ„]</strong> åœ¨ <code>npm run build</code> å¯èƒ½ä¼šæŠ¥é”™ï¼š<code>.tap(*)</code> ä¹‹ç±»çš„ï¼Œé‚£æ˜¯å› ä¸ºæ‰“åŒ…ä¸­çš„ <code>html-webpack-plugin</code> ç‰ˆæœ¬å‡ºç°äº†é—®é¢˜ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢çš„è¯­å¥</p><pre class="language-bash"><code class="language-bash"><span class="token comment"># è¿™ä¸ªç‰ˆæœ¬å°±æ˜¯ä½ çš„ package.json ä¸­çš„ç‰ˆæœ¬ï¼Œåªä¸è¿‡ä½ éœ€è¦é‡æ–°å†æŒ‡å®šè¿™ä¸ªç‰ˆæœ¬</span>

$ <span class="token function">npm</span> i html-webpack-plugin@4.0.0-alpha -D
</code></pre><h2 id="nginx-çš„é…ç½®" tabindex="-1">Nginx çš„é…ç½® <a class="header-anchor" href="#nginx-çš„é…ç½®" aria-hidden="true">#</a></h2><ul><li>é¦–å…ˆæˆ‘çš„ç›®å½•æ˜¯è¿™æ ·çš„ï¼Œæ— å…³æ–‡ä»¶å…¨éƒ¨ä»¥ <code>...</code> å±•ç¤º</li></ul><pre class="language-nginx"><code class="language-nginx">.
â”œâ”€conf
â”‚  â”œâ”€... <span class="token comment"># å…¶ä»–æ–‡ä»¶</span>
â”‚  â””â”€nginx.conf
â”‚
â”œâ”€html <span class="token comment"># åªçœ‹è¿™é‡Œï¼Œå…¶ä»–æš‚æ—¶æˆ‘æ²¡ç”¨åˆ° </span>
â”‚  â”œâ”€project1
â”‚  â”‚  â””â”€static
â”‚  â”‚      â”œâ”€css
â”‚  â”‚      â”œâ”€fonts
â”‚  â”‚      â””â”€js
â”‚  â”‚          â”œâ”€g
â”‚  â”‚          â””â”€V
â”‚  â”œâ”€project2
â”‚  â”‚   â””â”€static
â”‚  â”‚       â”œâ”€css
â”‚  â”‚       â”œâ”€fonts
â”‚  â”‚       â””â”€js
â”‚  â”‚           â”œâ”€g
â”‚  â”‚           â””â”€V
â”‚  â”œâ”€index.html
â”‚  â””â”€50x.html
â””â”€... <span class="token comment"># å…¶ä»–æ–‡ä»¶</span>
</code></pre><p><strong>[è§£é‡Š]</strong> æˆ‘çš„ <code>nginx</code> ç›®å½•å°±æ˜¯åŸç”Ÿçš„ï¼Œå†…éƒ¨åŒ…å«äº†ä¸€ä¸ª <code>html</code> æ–‡ä»¶å¤¹ï¼Œä¸ºäº†çœäº‹ï¼Œæˆ‘ç›´æ¥ä½¿ç”¨è¿™ä¸ªï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æŒ‡å®šå…¶ä»–çš„ç›®å½•ï¼Œä½†æ˜¯ç›®å‰è¿˜è¯·å’Œæˆ‘ä¸€æ ·çš„é…ç½®ï¼Œåé¢å¯ä»¥è‡ªå·±å®šåˆ¶åŒ–ã€‚</p><ul><li>ç°åœ¨æˆ‘ä»¬å¼€å§‹é…ç½®åœ¨ <code>conf</code> æ–‡ä»¶å¤¹ä¸‹çš„ <code>nginx.conf</code> æ–‡ä»¶</li></ul><p>æˆ‘æ˜¯ç›´æ¥åœ¨åŸå§‹æ–‡ä»¶ä¸Šä¿®æ”¹çš„ï¼Œè€Œä¿®æ”¹çš„é…ç½®éƒ½æ˜¯åœ¨ <code>http</code> æ¨¡å—ä¸­ï¼Œæ‰€ä»¥å…¶ä»–çš„ä¸éœ€è¦çš„ä»£ç æˆ‘ç›´æ¥ç”¨ <code>...</code> ä»£æ›¿ã€‚</p><pre class="language-nginx"><code class="language-nginx"><span class="token comment"># ...</span>
<span class="token comment"># åå‘ä»£ç†</span>
<span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">{</span>
  <span class="token directive"><span class="token keyword">include</span> mime.types</span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">default_type</span> application/octet-stream</span><span class="token punctuation">;</span>

  <span class="token comment">#log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</span>
  <span class="token comment">#                  '$status $body_bytes_sent "$http_referer" '</span>
  <span class="token comment">#                  '"$http_user_agent" "$http_x_forwarded_for"';</span>

  <span class="token directive"><span class="token keyword">sendfile</span>        <span class="token boolean">on</span></span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">keepalive_timeout</span>  <span class="token number">65</span></span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">client_max_body_size</span> <span class="token number">20M</span></span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">client_body_buffer_size</span> <span class="token number">10M</span></span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">large_client_header_buffers</span> <span class="token number">4</span> <span class="token number">128k</span></span><span class="token punctuation">;</span>
	
  <span class="token comment"># è¿™é‡Œå¯ä»¥åšé›†ç¾¤</span>
	<span class="token directive"><span class="token keyword">upstream</span> p1_server</span> <span class="token punctuation">{</span>
		<span class="token directive"><span class="token keyword">server</span> localhost:8081</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment"># è¿™é‡Œå¯ä»¥åšé›†ç¾¤</span>
	<span class="token directive"><span class="token keyword">upstream</span> p2_server</span> <span class="token punctuation">{</span>
		<span class="token directive"><span class="token keyword">server</span> localhost:8082</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

  <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">8080</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span> localhost</span><span class="token punctuation">;</span>
	  <span class="token directive"><span class="token keyword">charset</span> utf-8</span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">proxy_connect_timeout</span> <span class="token number">180</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_send_timeout</span> <span class="token number">180</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_read_timeout</span> <span class="token number">180</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_set_header</span> Host <span class="token variable">$host</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_set_header</span> X-Forwarder-For <span class="token variable">$remote_addr</span></span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">root</span> html</span><span class="token punctuation">;</span> <span class="token comment"># è¿™é‡ŒæŒ‡å®šåˆšåˆšæˆ‘ä»¬çš„æ–‡ä»¶å¤¹</span>
		
    <span class="token comment"># æ€»çš„é¡¹ç›®è·¯ç”±ï¼Œæˆ‘å·æ‡’ç›´æ¥å†™åœ¨äº†åŒä¸€ä¸ªæ–‡ä»¶</span>
    <span class="token comment"># å¦‚æœæœ‰å¾ˆå¤šå¯ä»¥åœ¨é…ç½®å¤šä¸ª conf æ–‡ä»¶ï¼Œä½¿ç”¨ include å…³è”è¿›æ¥</span>
		<span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
      <span class="token directive"><span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.html</span><span class="token punctuation">;</span> <span class="token comment"># è¿™é‡Œå¯ä»¥ç†è§£æŒ‡å®šåˆ° html æ–‡ä»¶å¤¹ä¸‹çš„ index.html</span>
		<span class="token punctuation">}</span>
		
    <span class="token comment"># project1</span>
    <span class="token comment"># è¿™é‡Œå°±æ˜¯åˆšåˆšæˆ‘ä»¬åœ¨ vue é¡¹ç›®ä¸­ config/index.js çš„é…ç½® build.assetsPublicPathï¼Œ</span>
    <span class="token comment"># ä¹Ÿæ˜¯ vue é¡¹ç›®ä¸­é…ç½®çš„ router ä¸­çš„ base</span>
		<span class="token directive"><span class="token keyword">location</span> ^~ /project1</span> <span class="token punctuation">{</span>
      <span class="token directive"><span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /project1/index.html</span><span class="token punctuation">;</span> <span class="token comment"># è¿™é‡Œå¯ä»¥ç†è§£æŒ‡å®šåˆ° html æ–‡ä»¶å¤¹ä¸‹ project1 æ–‡ä»¶å¤¹ çš„ index.html</span>
		<span class="token punctuation">}</span>
		
    <span class="token comment"># project2</span>
    <span class="token comment"># è¿™é‡Œæ˜¯é¡¹ç›®äºŒçš„é…ç½®</span>
		<span class="token directive"><span class="token keyword">location</span> ^~ /project2</span> <span class="token punctuation">{</span> <span class="token comment"># </span>
      <span class="token directive"><span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /project2/index.html</span><span class="token punctuation">;</span> <span class="token comment"># è¿™é‡Œå¯ä»¥ç†è§£æŒ‡å®šåˆ° html æ–‡ä»¶å¤¹ä¸‹ project2 æ–‡ä»¶å¤¹ çš„ index.html</span>
		<span class="token punctuation">}</span>
		
    <span class="token comment"># è¿™é‡Œæ˜¯ project1 é…ç½®éœ€è¦è°ƒç”¨çš„æ¥å£</span>
		<span class="token directive"><span class="token keyword">location</span> /api/pro1</span> <span class="token punctuation">{</span> <span class="token comment"># è¿™é‡Œå°±æ˜¯åœ¨ vue é¡¹ç›®ä¸­ prod.env.js çš„é…ç½® BASE_API </span>
			<span class="token directive"><span class="token keyword">proxy_redirect</span> <span class="token boolean">off</span></span><span class="token punctuation">;</span>
			<span class="token directive"><span class="token keyword">proxy_set_header</span> Host <span class="token variable">$host</span></span><span class="token punctuation">;</span>
			<span class="token directive"><span class="token keyword">proxy_set_header</span> X-Real-IP <span class="token variable">$remote_addr</span></span><span class="token punctuation">;</span>
			<span class="token directive"><span class="token keyword">proxy_set_header</span> X-Forwarded-For <span class="token variable">$proxy_add_x_forwarded_for</span></span><span class="token punctuation">;</span>
			<span class="token directive"><span class="token keyword">proxy_pass</span> http://p1_server</span><span class="token punctuation">;</span> <span class="token comment"># æ­¤å¤„çš„ p1_server å¯¹åº”çš„ä¸Šé¢çš„é…ç½® upstream p1_server {}ï¼Œè¿™é‡Œå¯ä»¥åšé›†ç¾¤ï¼Œæˆ‘ç”¨ä¸åˆ°ï¼Œå°±ç®€å•é…ç½®äº†</span>
    <span class="token punctuation">}</span>
        
    <span class="token comment"># è¿™é‡Œæ˜¯ project1 é…ç½®éœ€è¦è°ƒç”¨çš„æ¥å£</span>
    <span class="token directive"><span class="token keyword">location</span> /api/pro2</span> <span class="token punctuation">{</span> <span class="token comment"># è¿™é‡Œå°±æ˜¯åœ¨ vue é¡¹ç›®ä¸­ prod.env.js çš„é…ç½® BASE_API</span>
			<span class="token directive"><span class="token keyword">proxy_redirect</span> <span class="token boolean">off</span></span><span class="token punctuation">;</span>
			<span class="token directive"><span class="token keyword">proxy_set_header</span> Host <span class="token variable">$host</span></span><span class="token punctuation">;</span>
			<span class="token directive"><span class="token keyword">proxy_set_header</span> X-Real-IP <span class="token variable">$remote_addr</span></span><span class="token punctuation">;</span>
			<span class="token directive"><span class="token keyword">proxy_set_header</span> X-Forwarded-For <span class="token variable">$proxy_add_x_forwarded_for</span></span><span class="token punctuation">;</span>
			<span class="token directive"><span class="token keyword">proxy_pass</span> http://p2_server</span><span class="token punctuation">;</span>  <span class="token comment"># æ­¤å¤„çš„ p2_server å¯¹åº”çš„ä¸Šé¢çš„é…ç½® upstream p2_server {}ï¼Œè¿™é‡Œå¯ä»¥åšé›†ç¾¤ï¼Œæˆ‘ç”¨ä¸åˆ°ï¼Œå°±ç®€å•é…ç½®äº†</span>
    <span class="token punctuation">}</span>
    <span class="token comment"># ...</span>
  <span class="token punctuation">}</span>
  <span class="token comment"># ...</span>
<span class="token punctuation">}</span>
</code></pre><ul><li>æœ€åè´´å‡ºæˆ‘ä¿®æ”¹çš„ <code>index.html</code> çš„ä»£ç </li></ul><p>å› ä¸ºæˆ‘æ˜¯è¿½åŠ çš„ï¼Œæ‰€ä»¥ç›´æ¥è´´å‡ºæˆ‘è¿½åŠ çš„ä»£ç ï¼Œå…¶ä»–çš„é‡‡ç”¨ â€¦</p><pre class="language-html"><code class="language-html">...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>em</span><span class="token punctuation">&gt;</span></span>Thank you for using nginx.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>em</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- åŸç‰ˆæ–‡ä»¶çš„ä½ç½® --&gt;</span>

<span class="token comment">&lt;!-- start: è¿½åŠ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/project1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>é¡¹ç›®ä¸€<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span> | <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/project2<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>é¡¹ç›®äºŒ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- end: è¿½åŠ --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- åŸç‰ˆæ–‡ä»¶çš„ä½ç½® --&gt;</span>
</code></pre><h2 id="æœ€åçš„è°ƒè¯•" tabindex="-1">æœ€åçš„è°ƒè¯• <a class="header-anchor" href="#æœ€åçš„è°ƒè¯•" aria-hidden="true">#</a></h2><p>æ‰€æœ‰çš„é…ç½®å®Œæˆï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯åŠ¨ <code>nginx</code> äº†ï¼Œè¿™ä¸ªä¸ä¼šçš„è¯·è‡ªè¡Œè§£å†³äº†ã€‚</p><p>å¯åŠ¨æˆåŠŸï¼Œæˆ‘ä»¬åœ¨æµè§ˆå™¨è¾“å…¥ <code>http://localhost:8080</code> æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ï¼Œ</p><p>ç‚¹å‡»é¡¹ç›®ä¸€ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é“¾æ¥å˜ä¸º <code>http://localhost:8080/project1</code></p><p>ç‚¹å‡»é¡¹ç›®äºŒï¼Œé“¾æ¥å˜ä¸º <code>http://localhost:8080/project2</code>ï¼Œå®Œå…¨ç¬¦åˆæˆ‘ä»¬çš„æœŸæœ›ï¼Œé‚£å°±æˆåŠŸäº†ã€‚</p><p><strong>[å¼ºè¡Œè§£é‡Šä¸€ä¸‹ç„å­¦]</strong> é‚£å¤©é…ç½®å¥½äº†ï¼Œä¸€å¯åŠ¨å°±æŠ¥é”™ï¼Œå¼„çš„æˆ‘æœ€åæ”¾å¼ƒäº†ã€‚ä½†æ˜¯ç¬¬äºŒå¤©ï¼Œå‡†å¤‡åœ¨æ£€æŸ¥ä¸‹ï¼Œä¸€å¯åŠ¨ç«Ÿç„¶å…¨å¥½äº†ï¼Œæˆ‘éƒ½ä¸€è„¸æ‡µé€¼å•Šï¼ å¦‚æœä½ ä¹Ÿé‡åˆ°å’Œæˆ‘ä¸€æ ·çš„é—®é¢˜ï¼Œå…ˆæ”¾æ”¾ï¼Œè¯´ä¸å®šéš”å¤©å°±å¥½äº†ã€‚ğŸ˜„</p></div><!--]--></article><div class="prose m-auto mt-8 mb-8"><a href="/posts" class="font-mono no-underline opacity-50 hover:opacity-75">cd ..</a></div><!--]--><footer class="prose m-auto py-20 flex"><span class="text-sm">2018 - PRESENT Â© HeZulong</span><div class="flex-auto"></div></footer></main><!--]--></div><script></script></body></html>